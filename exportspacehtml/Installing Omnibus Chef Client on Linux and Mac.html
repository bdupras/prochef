<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Chef : Installing Omnibus Chef Client on Linux and Mac</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Chef : Installing Omnibus Chef Client on Linux and Mac
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Aug 03, 2012 by <font color="#0050B2">jessica</font>.
				    </div>

				    <table class="sectionMacro" border="0" cellpadding="5" cellspacing="0" width="100%"><tbody><tr>
<td class="confluenceTd" valign="top" width="3%"></td>
<td class="confluenceTd" valign="top">
<p><br class="atl-forced-newline" /></p>
<hr />
<p><span class="image-wrap" style="float: left"><a class="confluence-thumbnail-link 130x103" href='http://wiki.opscode.com/download../attachments/24773129/OC_Chef_Logo_small.png'><img src="../attachments/thumbnails/24773129/25002044" hspace="20" vspace="6" style="border: 0px solid black"/></a></span></p>
<div class="panel" style="background-color: #d7d4c3;border-width: 1px;"><div class="panelContent" style="background-color: #d7d4c3;">
<h4><a name="InstallingOmnibusChefClientonLinuxandMac-"></a><font color="#f7681a">These directions describe the Omnibus method of installing Chef client on a node running Linux or OS X.</font>  </h4>

<h5><a name="InstallingOmnibusChefClientonLinuxandMac-NodesarehostswhoseconfigurationthatyouwanttomanageusingChef."></a><a href="Nodes.html" title="Nodes">Nodes</a> are hosts whose configuration that you want to manage using Chef.  </h5>

<p><br class="atl-forced-newline" />
<b>In general, installing Omnibus chef-client on a node includes:</b></p>

<ul class="alternate" type="square">
	<li>Installing Embedded Ruby and Other Embedded Dependencies</li>
	<li>Installing Chef</li>
	<li>Configuring Chef</li>
</ul>
</div></div>

<p><br class="atl-forced-newline" /></p>
<h1><a name="InstallingOmnibusChefClientonLinuxandMac-OmnibusInstallation"></a>Omnibus Installation</h1>

<p>The <a href="http://www.opscode.com/chef/install">Chef Full Installer</a> has been tested with <font color="#f7681a">Debian, Ubuntu, CentOS, RHEL, Fedora, Oracle Linux, Scientific Linux, and OS X.</font> </p>

<p>You can install it by entering this command:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">sudo true &amp;&amp; curl -L http://opscode.com/chef/install.sh | sudo bash</pre>
		</div>
</div></div>
<p>Once it is installed there will be no icon for it. If needed, you can confirm it was installed correctly with these commands in a new command prompt window:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">% chef-client -v</pre>
		</div>
</div></div>
<p>You should see "10.12.0" returned as the version number.</p>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Get the error "Could not find RubyGem chef" instead?</b><br /><br class="atl-forced-newline" />
If you get an error that looks similar to the one below, you most likely have an issue with how your RVM is setup.
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">/opt/opscode/embedded/lib/ruby/1.9.1/rubygems.rb:762:in report_activate_error': Could not find RubyGem chef (&gt;= 0) (Gem::LoadError)</pre>
		</div>
</div></div>
<p>You can work around the environment variables RVM has setup by always using 'sudo -i' with the chef-client command. For instance, this would correctly return the version number:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">% sudo -i chef-client -v</pre>
		</div>
</div></div></td></tr></table></div>

<p>Upon installation, this script will:</p>

<ul>
	<li>Install all of the embedded dependencies for Chef</li>
	<li>Install an embedded version of Ruby and Rubygems</li>
	<li>Install chef-client and knife version 10.12.0</li>
</ul>


<p>After installation, you should move your validation client's private key onto the node and copy it to <tt>/etc/chef/</tt>.</p>
</td>
<td class="confluenceTd" valign="top" width="1%"></td>
<td class="confluenceTd" valign="top" width="28%">
<p><br class="atl-forced-newline" /></p>
<div class="panel" style="background-color: #d7d4c3;border-width: 1px;"><div class="panelContent" style="background-color: #d7d4c3;">
<div>
<ul>
    <li><a href='#InstallingOmnibusChefClientonLinuxandMac-OmnibusInstallation'>Omnibus Installation</a></li>
<ul>
    <li><a href='#InstallingOmnibusChefClientonLinuxandMac-Configurechefclient'>Configure chef-client</a></li>
</ul>
    <li><a href='#InstallingOmnibusChefClientonLinuxandMac-Bootstrap'>Bootstrap</a></li>
    <li><a href='#InstallingOmnibusChefClientonLinuxandMac-OmnibusInformation'>Omnibus Information</a></li>
</ul></div>
</div></div>
<p><br class="atl-forced-newline" /></p>
<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Commands Run as Root</b><br />Commands that require root privileges are run with <tt>sudo</tt> in these directions.  If your system is not configured to use <tt>sudo</tt>, run these commands as root using a method appropriate for your configuration.</td></tr></table></div>
<p><br class="atl-forced-newline" />
<div class="panel" style="background-color: #d7d4c3;border-width: 1px;"><div class="panelContent" style="background-color: #d7d4c3;">
<p><a name="InstallingOmnibusChefClientonLinuxandMac-SystemRequirements"></a></p>
<h3><a name="InstallingOmnibusChefClientonLinuxandMac-"></a><font color="#f7681a">System Requirements</font></h3>
<hr />
<p><font color="navy"><b>Chef-client is supported on the following platforms</b></font></p>

<ul>
	<li>Ubuntu (10.04+)</li>
	<li>Debian (5.0, 6.0)</li>
	<li>RHEL &amp; CentOS (5.x, 6.x)</li>
	<li>Fedora 10&#43;</li>
	<li>Solaris 9,10,11 Sparc</li>
	<li>Solaris 10,11 (x86 and x64)</li>
	<li>Mac OS X (10.4, 10.5, 10.6, 10.7)</li>
	<li>Windows 7</li>
	<li>Windows Server 2003 R2, 2008 R2</li>
</ul>


<p>Additionally, chef-client is known to run on the following platforms</p>

<ul>
	<li>Ubuntu (6.06, 8.04-9.10)</li>
	<li>RHEL &amp; CentOS (5.x)</li>
	<li>Gentoo (11.1,11.2)</li>
	<li>FreeBSD (7.1)</li>
	<li>OpenBSD (4.4)</li>
	<li>OpenSolaris (2008.11)</li>
	<li>Solaris 5.10 (u6)</li>
	<li>SuSE (11.x)</li>
	<li>Windows Vista</li>
</ul>


<p><br class="atl-forced-newline" /></p>
</div></div></p></td>
<td class="confluenceTd" valign="top" width="5%"></td></tr></tbody></table>
<table class="sectionMacro" border="0" cellpadding="5" cellspacing="0" width="100%"><tbody><tr>
<td class="confluenceTd" valign="top" width="3%"></td>
<td class="confluenceTd" valign="top">

<p><h2><a name="InstallingOmnibusChefClientonLinuxandMac-Configurechefclient"></a>Configure chef-client</h2>

<p>The initial configuration of a chef-client requires a <tt>client.rb</tt> configuration file and a <tt>validation.pem</tt> file to be placed in <tt>/etc/chef</tt>.   At a minimum <tt>client.rb</tt> must contain the configuration settings necessary for chef-client to communicate with chef-server.  <tt>validation.pem</tt> is the permission certificate for your validator client.  This API client is used on the first-run of chef-client and is used to create a new API client for the node.  To create these we do the following:</p>

<ol>
	<li>Create <tt>/etc/chef</tt>:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[sudo mkdir -p /etc/chef]]></script>
</div></div></li>
	<li>Create <tt>client.rb</tt> and <tt>validation.pem</tt>:
<br class="atl-forced-newline" />
<br class="atl-forced-newline" />
<b>If you have a properly configured workstation</b>, you should be able to run the following command from your workstation's chef repository
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[knife configure client ./]]></script>
</div></div>
<p>This will place <tt>client.rb</tt> and <tt>validation.pem</tt> in your current working directory on your chef workstation.  You can then use <tt>scp</tt> or another method to move both files into <tt>/etc/chef</tt> on the node you are configuring.
<br class="atl-forced-newline" />
<br class="atl-forced-newline" />
<b>If you do not have a configured workstation</b>, you should create a minimal <tt>/etc/chef/client.rb</tt>.  If you are using your own chef-server <tt>client.rb</tt> should look as follows (substituting the correct address of your chef server):</p>
<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>client.rb</b></div><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[log_level        :info
log_location     STDOUT
chef_server_url  'http://yourchefserver.com:4000'
validation_client_name 'chef-validator']]></script>
</div></div>
<p>If you are using Hosted Chef, <tt>client.rb</tt> should look as follows (with ORGNAME replaced with your Organization Short Name}}:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>client.rb for Hosted Chef</b></div><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[log_level        :info
log_location     STDOUT
chef_server_url  'https://api.opscode.com/organizations/ORGNAME'
validation_key         "/etc/chef/ORGNAME-validator.pem"
validation_client_name 'ORGNAME-validator']]></script>
</div></div>
<p><br class="atl-forced-newline" />
<br class="atl-forced-newline" />
<b>Your <tt>validation.pem</tt> can be downloaded from your chef-server if you are running your own chef-server.  On your Chef Server, <tt>validation.pem</tt> should be in <tt>/etc/chef/</tt>. Users of Hosted Chef can find their validator client's key from the <a href="Managing Organizations with the Hosted Chef Management Console.html" title="Managing Organizations with the Hosted Chef Management Console">Hosted Chef Management Console</a>.  Note that if you are using Hosted Chef, your key is named <tt>ORGNAME-validator.pem</tt>.</b></p></li>
</ol>


<p>Chef client has a number of configuration settings that do not appear above. See <a href="Chef Configuration Settings.html" title="Chef Configuration Settings">Chef Configuration Settings</a> for further details.</p></p>

<h3><a name="InstallingOmnibusChefClientonLinuxandMac-InstallSupportingPackages"></a>Install Supporting Packages</h3>

<p><font color="#f7681a">The following packages are not required to run the chef-client or chef-solo and are optional.</font></p>

<ul>
	<li>libopenssl-ruby - if the chef-server has SSL (like the Opscode Platform), this is required.</li>
	<li>ruby-dev and build-essential - required to build gems that have native extensions from source with gem_package</li>
</ul>


<h1><a name="InstallingOmnibusChefClientonLinuxandMac-Bootstrap"></a>Bootstrap</h1>

<p>It is often easiest to install Chef on a node using knife-bootstrap. Bootstrapping runs a script on the target system which install Ruby, install chef-client, configure chef-client, and start a chef-client run. This method requires the node to be accessible over SSH.  In most cases, bootstrapping a new node will be as simple as running a single command.  For instance, to bootstrap a Linux workstation using the Omnibus installation method you might run the following command:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">knife bootstrap IP_ADDR -d chef-full --sudo</pre>
		</div>
</div></div>

<p>See <a href="Knife Bootstrap.html" title="Knife Bootstrap">Knife Bootstrap</a> and <a href="Launch Cloud Instances with Knife.html" title="Launch Cloud Instances with Knife">Launch Cloud Instances with Knife</a> for complete documentation.  The bootstrap scripts distributed with knife for Ubuntu use an install method similar to the installation methods above.</p>


<p><p><br class="atl-forced-newline" /></p>
<h1><a name="InstallingOmnibusChefClientonLinuxandMac-OmnibusInformation"></a>Omnibus Information</h1>

<p>There are a few ways that the Omnibus install is different from installing through rubygems or your OS's packaging system such as 'yum' or 'apt'.</p>

<h3><a name="InstallingOmnibusChefClientonLinuxandMac-TestedOperatingSystems"></a>Tested Operating Systems</h3>
<p>Omnibus will work to install Chef on many Linux operating systems and OS X. <b><font color="#f7681a">It has been tested with Debian, Ubuntu, CentOS, RHEL, Fedora, Oracle Linux, Scientific Linux, and OS X.</font></b> You can find information on installing the Windows version of Omnibus on the <a href="Installing Chef Client on Windows.html" title="Installing Chef Client on Windows">Installing Chef Client on Windows</a> page.</p>

<h3><a name="InstallingOmnibusChefClientonLinuxandMac-OmnibusPackaging"></a>Omnibus Packaging</h3>
<p>The Omnibus installers are built using the same Ruby based Open Source project we use for packaging Private Chef. A couple of the installers are built with older build systems, and we plan to migrate them in the coming months. We also expect to add more platforms in the future.</p>

<p>Omnibus wraps itself in a package specific to your distribution where possible, such as a deb or rpm, so you can easily manage it using the tools you’re familiar with. If you prefer regular packages or installing from Rubygems for policy or personal reasons, you can find links to those directions on the <a href="Installing Chef Client and Chef Solo.html" title="Installing Chef Client and Chef Solo">Installing Chef Client and Chef Solo</a> page.</p>

<h3><a name="InstallingOmnibusChefClientonLinuxandMac-EmbeddedRubyandOtherDependencies"></a>Embedded Ruby and Other Dependencies</h3>
<p>The Omnibus installer includes the Chef client, a stable version of Ruby, and everything else needed for Chef to run, in a single package. The dependencies are all carefully embedded so they won’t conflict with other versions of the same software on your system. Because you are also using an embedded version of rubygems <b><font color="#f7681a">you'll want to use a command like "sudo /opt/chef/embedded/bin/gem install knife-PLUGIN" to install any knife plugins on an Omnibus workstation.</font></b></p>

<h3><a name="InstallingOmnibusChefClientonLinuxandMac-ChefgemandGempackageresources"></a>Chef_gem and Gem_package resources</h3>
<p>Because Omnibus includes its own version of Rubygems, <b>it is important that you correctly use the gem_package and chef_gem resources.</b> The gem_package resource is for installing a gem package to your system, whereas the chef_gem resource is for install a gem for use inside a chef recipe. Additional information is available on the <a href="http://wiki.opscode.com/display/chef/Resources">Resources</a> wiki page.</p></p>

<p><br class="atl-forced-newline" />
<br class="atl-forced-newline" />
<br class="atl-forced-newline" />
<br class="atl-forced-newline" /></p></td>
<td class="confluenceTd" valign="top" width="5%"></td></tr></tbody></table>
<table class="sectionMacro" border="0" cellpadding="5" cellspacing="0" width="100%"><tbody><tr>
<hr />
<td class="confluenceTd" valign="top" width="45%">

<p><span class="image-wrap" style="float: left"><img src="../attachments/24773129/25002038.png" hspace="4" style="border: 0px solid black"/></span> <br/>
<a href="Installing Chef Client and Chef Solo.html" title="Installing Chef Client and Chef Solo">Installing Chef Client and Chef Solo</a></p>
</td>
<td class="confluenceTd" valign="top" width="40%"></td>

<td class="confluenceTd" valign="top" width="15%">

<p><span class="image-wrap" style="float: right"><img src="../attachments/24773129/25002039.png" hspace="4" style="border: 0px solid black"/></span> <br/>
<a href="Upgrade Instructions.html" title="Upgrade Instructions">Upgrade Instructions</a></p>

<p><br class="atl-forced-newline" />
<br class="atl-forced-newline" /></p></td></tr></tbody></table>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">
                                <h2>Attachments:</h2>
                            </a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="../attachments/24773129/25002038.png">leftarrow.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="../attachments/24773129/25002039.png">rightarrow.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="../attachments/24773129/25002044.png">OC_Chef_Logo_small.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://wiki.opscode.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Aug 04, 2012 00:05</font></td>
		    </tr>
	    </table>
    </body>
</html>
